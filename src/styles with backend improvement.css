:root{
    --bg:#f0f2f5; --card:#ffffff; --text:#111827; --muted:#6b7280; --line:#e5e7eb;
    --blue:#1877f2; --blue-ink:#0b5cc4; --shadow:0 1px 2px rgba(0,0,0,.06),0 4px 12px rgba(0,0,0,.06);
    --warn:#b45309; --warn-bg:#fff7ed;
  
    /* layout knobs */
    --rail-l: 360px;
    --rail-r: 360px;
    --feed-min: 640px;
    --feed-max: 700px;
    --gap: 16px;
    --rail-gap: 30px;
    --feed-gap: 12px;
    --page-edge-left: 27px;
  
    /* menu knobs (wider, smaller font, scroll after 7 items) */
    --menu-font: .85rem;
    --menu-min-w: 320px;
    --menu-max-w: 380px;
    --menu-pad: .28rem;
    --menu-item-vpad: .45rem;
    --menu-item-hpad: .65rem;
    --menu-icon-size: 16px;
    --menu-item-h: 44px;       /* approx row height for calc */
    --menu-max-items: 7;       /* scroll after 7 items */
  }
  
  /* base */
  *{box-sizing:border-box}
  html,body,#root{height:100%}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--text)}
  a{color:var(--blue);text-decoration:none}
  a:hover{text-decoration:underline}
  
  /* Top bar */
  .nav{position:sticky;top:0;z-index:40;background:rgba(255,255,255,.9);backdrop-filter:saturate(180%) blur(8px);border-bottom:1px solid var(--line)}
  .nav-inner{max-width:960px;margin:0 auto;display:flex;gap:.5rem;align-items:center;padding:.5rem .75rem}
  
  /* Inputs / buttons */
  .input{border:1px solid var(--line);border-radius:.5rem;padding:.375rem .5rem;font-size:.9rem}
  .select{border:1px solid var(--line);border-radius:.5rem;padding:.35rem .5rem;background:#fff;font-size:.9rem}
  .btn{border:1px solid var(--line);border-radius:.5rem;background:#fff;padding:.375rem .6rem;font-size:.9rem;cursor:pointer}
  .btn:hover{background:#f9fafb}
  .btn.primary{background:var(--blue);border-color:var(--blue);color:#fff}
  .btn.primary:hover{background:var(--blue-ink)}
  .btn.toggle.active{background:#111827;color:#fff}
  
  /* Default container */
  .container{max-width:700px;margin:0 auto;padding:12px}
  
  /* Cards */
  .composer,.card{background:var(--card);border:1px solid var(--line);border-radius:1rem;box-shadow:var(--shadow)}
  .composer{padding:1rem;margin-bottom:1rem}
  .composer-row{display:flex;gap:.75rem;align-items:center}
  .avatar{width:40px;height:40px;border-radius:999px;background:#e5e7eb;flex:0 0 auto;overflow:hidden}
  .avatar-img{width:40px;height:40px;border-radius:999px;object-fit:cover;display:block}
  .composer-btn{flex:1;text-align:left;background:#f3f4f6;border:none;border-radius:999px;padding:.6rem .9rem;color:#4b5563;cursor:pointer}
  .composer-actions{display:flex;gap:.5rem;margin-top:.75rem;color:#6b7280}
  .composer-chip{padding:.35rem .55rem;border-radius:.5rem;cursor:pointer}
  .composer-chip:hover{background:#f3f4f6}
  
  .card{overflow:hidden;margin-bottom:1rem;border-radius:.75rem}
  .card-head{display:flex;gap:.75rem;align-items:center;padding:1rem 1rem .25rem}
  .name{font-weight:600}
  .name-row{display:flex;align-items:center;gap:.4rem;flex-wrap:wrap}
  .meta{font-size:.75rem;color:var(--muted)}
  .dots{border:none;background:transparent;padding:.25rem .4rem;border-radius:999px;cursor:pointer;color:#6b7280}
  .dots:hover{background:#f3f4f6}
  .card-body{padding:.25rem 1rem .75rem}
  .text{margin:.25rem 0;font-size:15px;line-height:1.5;white-space:pre-wrap}
  .image-btn{display:block;width:100%;border:none;background:transparent;padding:0;cursor:pointer}
  
  /* Footer actions */
  .footer{padding:.5rem;border-top:1px solid var(--line);overflow:visible}
  .actions{display:grid;grid-template-columns:repeat(3,1fr);gap:.5rem;overflow:visible}
  .action{display:flex;align-items:center;justify-content:center;gap:.4rem;padding:.5rem .5rem;border:1px solid transparent;border-radius:.75rem;cursor:pointer;color:#374151;background:#fff;min-height:38px;width:100%}
  .action:hover{background:#f3f4f6}
  .action.active{background:#e7f0ff;color:var(--blue)}
  
  /* Modal (header + body scroll + footer) */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);display:flex;align-items:center;justify-content:center;padding:1rem;z-index:50}
  .modal{
    background:#fff;border-radius:1rem;box-shadow:var(--shadow);
    width:calc(100vw - 48px);max-width:680px;max-height:90vh;
    display:flex;flex-direction:column;overflow:hidden;
  }
  .modal.modal-wide{max-width:1120px;width:calc(100vw - 64px)}
  .modal-head{flex:0 0 auto;display:flex;align-items:center;justify-content:space-between;padding:.75rem 1rem;border-bottom:1px solid var(--line)}
  .modal-body{flex:1 1 auto;padding:1rem;overflow:auto;-webkit-overflow-scrolling:touch}
  .modal-footer{flex:0 0 auto;padding:10px 16px;border-top:1px solid var(--line);background:#fff;display:flex;gap:.5rem;justify-content:flex-end}
  .textarea{width:100%;border:1px solid var(--line);border-radius:.75rem;padding:.75rem;font-size:1rem;outline:none}
  .textarea:focus{border-color:var(--blue);box-shadow:0 0 0 3px rgba(24,119,242,.15)}
  
  /* Misc */
  .toast{position:fixed;left:50%;transform:translateX(-50%);bottom:16px;background:#000;color:#fff;padding:.5rem .75rem;border-radius:.5rem;font-size:.85rem;box-shadow:var(--shadow)}
  .end{color:#6b7280;text-align:center;font-size:.9rem;padding:1.5rem}
  .link-row{display:flex;flex-wrap:wrap;gap:.75rem;margin-top:.5rem}
  .link{font-size:.9rem}
  
  /* Admin FAB */
  .btn.admin-fab{background:#fff;border:1px solid var(--line);border-radius:50%;width:44px;height:44px;display:flex;align-items:center;justify-content:center;font-size:.85rem;opacity:.6;transition:opacity .2s ease}
  .btn.admin-fab:hover{opacity:1}
  .submit-wrap{text-align:center;margin:.5rem 0 1.5rem}
  .btn-wide{display:block;width:100%;max-width:300px;margin:1rem auto}
  
  /* Gated blur */
  .app-shell{transition:filter .2s ease,opacity .2s ease}
  .app-shell.blurred{filter:blur(6px);opacity:.85;pointer-events:none;user-select:none}
  
  /* “See more” clamp */
  .text-wrap{position:relative}
  .text.clamp{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  .fade-more{position:absolute;right:0;bottom:0;height:1.6em;display:inline-flex;align-items:center;gap:.35ch;background:var(--card);padding-left:.25ch;z-index:1}
  .fade-more::before{content:"";position:absolute;right:100%;top:0;width:6ch;height:100%;background:linear-gradient(90deg, rgba(255,255,255,0), var(--card));pointer-events:none}
  .dots{font:inherit;line-height:inherit;display:inline}
  .see-more{background:none;border:none;padding:0;display:inline;cursor:pointer;font:inherit;line-height:inherit;color:#1d4ed8}
  
  /* Badge */
  .badge{display:inline-flex;align-items:center}
  .badge svg{vertical-align:middle}
  
  /* Dots menu */
  .menu-wrap{position:relative;overflow:visible}
  .menu{
    position:absolute;
    right:.5rem; top:2.25rem;
    min-width:var(--menu-min-w);
    max-width:var(--menu-max-w);
    max-height: calc(var(--menu-item-h) * var(--menu-max-items));
    overflow-y:auto;
    background:#fff;
    border:1px solid var(--line);
    border-radius:.75rem;
    box-shadow:var(--shadow);
    z-index:1000;
    padding:var(--menu-pad);
    animation:menuIn .08s ease-out;
    font-size:var(--menu-font);
    line-height:1.3;
    scrollbar-width:thin;
  }
  .menu::-webkit-scrollbar{width:6px}
  .menu::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:4px}
  .menu::-webkit-scrollbar-thumb:hover{background:#9ca3af}
  
  .menu-item{
    display:flex; align-items:flex-start; gap:.55rem;
    padding:var(--menu-item-vpad) var(--menu-item-hpad);
    border-radius:.55rem;
    cursor:pointer;
    color:#111827;
    background:transparent; border:none; width:100%; text-align:left;
  }
  .menu-item:hover{background:#f3f4f6}
  .menu-divider{height:1px;background:var(--line);margin:.28rem .1rem}
  
  .menu-item .mi-icon{
    width:var(--menu-icon-size);height:var(--menu-icon-size);
    flex:0 0 var(--menu-icon-size);color:#111827
  }
  .menu-item .mi-text{display:flex;flex-direction:column;min-width:0}
  .menu-item .mi-title{font-weight:600;font-size:.88rem;line-height:1.15}
  .menu-item .mi-sub{font-size:.78rem;color:var(--muted);margin-top:.16rem}
  
  /* greyed-out, non-interactive entries */
  .menu-item.disabled{opacity:.45;cursor:not-allowed;pointer-events:none}
  
  @keyframes menuIn{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:translateY(0)}}
  .card-head .dots{position:relative;z-index:1001}
  .card{overflow:visible}
  
  /* Info bars */
  .info-bar{padding:.5rem 1rem;border-top:1px solid var(--line);font-size:.95rem}
  .info-head{display:flex;align-items:center;gap:.4rem}
  .info-icon{color:#6b7280;flex-shrink:0}
  .info-title{font-weight:700}
  .info-sub{margin-top:.25rem;line-height:1.5;color:var(--muted)}
  .info-row{margin-top:.35rem;display:flex;align-items:center;gap:.5rem;color:var(--muted)}
  .info-clean{background:transparent}
  
  .note-bar{padding:.5rem 1rem;border-top:1px solid var(--line);font-size:.95rem}
  .note-head{display:flex;align-items:center;gap:.4rem}
  .note-icon{color:#2563eb;flex-shrink:0}
  .note-title{font-weight:700}
  .note-sub{margin-top:.25rem;line-height:1.5}
  .note-row{margin-top:.35rem;display:flex;align-items:center;gap:.5rem;color:var(--muted)}
  
  /* Reactions summary */
  .bar-stats{display:flex;justify-content:space-between;align-items:center;padding:.5rem 1rem;border-top:1px solid var(--line);font-size:.9rem}
  .bar-stats .left{display:flex;align-items:center;gap:.5rem;white-space:nowrap}
  .muted{color:var(--muted)}
  .rx-stack{display:flex;align-items:center;flex:0 0 auto}
  .rx-stack .rx{width:18px;height:18px;border-radius:999px;display:grid;place-items:center;font-size:12px;border:1px solid #fff;margin-right:-6px;background:#fff}
  
  /* Like flyout */
  .like-wrap{position:relative; display:flex; flex:1; overflow:visible;}
  .like-wrap .action{flex:1; justify-content:center;}
  .react-flyout{position:absolute;bottom:100%;left:.5rem;transform:translateY(-6px);background:#fff;border:1px solid var(--line);border-radius:999px;padding:.3rem .4rem;box-shadow:var(--shadow);display:flex;gap:.25rem;z-index:30;white-space:nowrap;pointer-events:auto}
  .react-flyout button{width:32px;height:32px;border-radius:999px;border:none;background:transparent;display:grid;place-items:center;font-size:18px;cursor:pointer;transition:transform .06s ease-out}
  .react-flyout button:hover{transform:scale(1.15)}
  
  /* ===================== 3-column page ===================== */
  .page{
    display:grid;
    grid-template-columns: var(--rail-l) minmax(var(--feed-min), var(--feed-max)) var(--rail-r);
    gap: var(--gap);
    width: 100%;
    max-width: none;
    margin: 0;
    padding: 0 0 0 var(--page-edge-left);
  }
  
  .page .container.feed{padding:0 !important;margin-top:0 !important}
  .page .feed > .card:first-child{margin-top:var(--feed-gap)}
  
  .rail{
    position: sticky;
    align-self: start;
    top: var(--rail-gap);
    height: calc(100vh - var(--rail-gap));
    overflow: hidden;
    pointer-events: none; user-select: none;
    filter: grayscale(1) blur(1px);
    opacity: .55;
    width: 100%;
  }
  .rail > *:first-child{margin-top:0 !important}
  
  /* ---------- Ghost UI ---------- */
  .ghost-card{background:#fff;border:1px solid var(--line);border-radius:1rem;box-shadow:var(--shadow);margin-bottom:12px;height:auto}
  .ghost-card.banner{height:180px}
  .ghost-card.box{padding:.75rem}
  .ghost-profile{display:flex;align-items:center;gap:.6rem;padding:.6rem .75rem}
  .ghost-avatar{width:32px;height:32px;border-radius:999px;background:#e5e7eb;flex:0 0 auto}
  .ghost-avatar.sm{width:28px;height:28px}
  .ghost-avatar.xl{width:44px;height:44px}
  .ghost-avatar.online{position:relative}
  .ghost-avatar.online::after{content:"";position:absolute;right:-1px;bottom:-1px;width:8px;height:8px;border:2px solid #fff;border-radius:999px;background:#22c55e}
  .ghost-lines{flex:1}
  .ghost-line{height:8px;border-radius:4px;margin:.22rem 0;background-image:linear-gradient(90deg,#eef2f7 0%,#f7f9fc 50%,#eef2f7 100%);background-size:220px 100%;animation:ghostShimmer 2.8s ease-in-out infinite}
  .ghost-line.w-35{width:35%}.ghost-line.w-40{width:40%}.ghost-line.w-45{width:45%}.ghost-line.w-60{width:60%}.ghost-line.w-70{width:70%}
  .ghost-list{background:#fff;border:1px solid var(--line);border-radius:1rem;box-shadow:var(--shadow);padding:.5rem}
  .ghost-item{display:flex;align-items:center;gap:.6rem;padding:.45rem .5rem;border-radius:.5rem}
  .ghost-item + .ghost-item{margin-top:.1rem}
  .ghost-item.icon .ghost-icon{width:28px;height:28px;border-radius:8px;background:#e5e7eb;flex:0 0 auto}
  .ghost-title{width:120px;height:10px;border-radius:4px;background:#eef2f7;margin:8px 4px}
  .ghost-row{display:flex;align-items:center;gap:.6rem;padding:.35rem 0}
  @keyframes ghostShimmer{0%{background-position:-220px 0}100%{background-position:220px 0}}
  
  /* ---------- Responsive collapse ---------- */
  @media (max-width: 1200px){
    .page{ grid-template-columns: 0 minmax(var(--feed-min), 1fr) var(--rail-r); }
    .rail-left{ display:none; }
  }
  @media (max-width: 1024px){
    .page{ grid-template-columns: minmax(0,1fr); padding-left: 0; }
    .rail-right{ display:none; }
    .page .feed{ padding: 12px; }
  }
  
  /* ---------- Editor (Admin) ---------- */
  /* grid: left form (unchanged) | right preview (wider) */
  .editor-grid {
    display: grid;
    gap: 16px;
    grid-template-columns: 1fr 480px; /* form | preview wider */
  }
  @media (max-width: 980px) { .editor-grid { grid-template-columns: 1fr; } }
  
  /* Left column */
  .editor-form { display: grid; gap: .75rem; }
  .section-title { margin: .25rem 0; font-size: .95rem; font-weight: 700; color: #374151; }
  .fieldset { border: 1px solid var(--line); border-radius: .5rem; padding: .75rem; display: grid; gap: .75rem; }
  .grid-2 { display: grid; gap: .5rem; grid-template-columns: 1fr 1fr; }
  .grid-3 { display: grid; gap: .5rem; grid-template-columns: repeat(3, 1fr); }
  @media (max-width: 640px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }
  .avatar-preview { display: flex; align-items: center; justify-content: flex-end; }
  .subtle { font-size: .85rem; color: #6b7280; margin-bottom: .25rem; }
  
  /* Reaction pills */
  .rx-pills { display: flex; flex-wrap: wrap; gap: .5rem; }
  .pill { display: inline-flex; align-items: center; gap: .35rem; border: 1px solid var(--line); border-radius: .5rem; padding: .25rem .55rem; cursor: pointer; user-select: none; }
  .pill input { display: none; }
  .pill .emoji { font-size: 1rem; }
  .pill.active { background: #f3f4f6; border-color: #e5e7eb; }
  
  /* Sticky action row inside left panel (kept) */
  .editor-actions { position: sticky; bottom: 0; background: #fff; padding-top: .75rem; margin-top: .25rem; display: flex; gap: .5rem; justify-content: flex-end; border-top: 1px solid var(--line); }
  
  /* Right column: preview */
  .editor-preview { position: sticky; top: 16px; align-self: start; }
  .preview-head { font-size: .85rem; color: #6b7280; margin-bottom: .5rem; padding-left: .25rem; }
  .editor-preview .card { box-shadow: none; border: 1px solid var(--line); }
  
  .preview-zoom {transform: scale(.9);transform-origin: top left;/* no width: calc(100% / .9) */}
  
/* --- Admin: Post Image preview (left panel) --- */
.editor-form .img-preview {
    border: 1px solid var(--line);
    border-radius: .5rem;
    background: #fafafa;
    padding: 8px;
    height: 260px;          /* keep the fixed preview window */
    width: 100%;
    display: flex;          /* center child */
    align-items: center;
    justify-content: center;
    overflow: hidden;       /* hide any stray overflow if needed */
  }
  
  /* Key: scale proportionally to fit entirely inside the box */
  .editor-form .img-preview > img,
  .editor-form .img-preview > svg,
  .editor-form .img-preview .svg-wrap > svg {
    max-width: 100% !important;
    max-height: 100% !important;
    width: auto !important;
    height: auto !important;
    object-fit: scale-down !important;   /* shrink if needed, never crop */
    display: block;
  }
  
  /* If you still have an old rule like `.img-preview img { width:100%; height:100%; }`
     make sure it's removed, or this extra guard keeps it from winning: */
  .editor-form .img-preview img { aspect-ratio: auto !important; }

.modal-body { overflow-x: hidden; }     /* only the vertical scroll remains */
.editor-preview { overflow: hidden; }   /* belt-and-suspenders */